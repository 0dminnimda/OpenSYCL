pkgname=hipsycl-git
pkgver=0.6.0
pkgrel=1
pkgdesc="SYCL implementation over CUDA/HIP."
arch=("x86_64")
url="https://github.com/illuhad/hipSYCL"
makedepends=("cmake")
depends=("cuda")
license=("BSD")

source=('hipSYCL::git+https://github.com/illuhad/hipSYCL.git')

md5sums=("SKIP")

pkgver() {
  cd "${srcdir}/hipSYCL"
  git log -1 --format=%cd.%h --date=short|tr -d -
}

prepare() {
  cd "${srcdir}/hipSYCL/contrib/HIP"
  git submodule init
  git submodule update
}

build() {
    mkdir -p ${srcdir}/hipSYCL/build
    cd "${srcdir}/hipSYCL/build"
    cmake -DCMAKE_BUILD_TYPE=Release \
          -DCMAKE_INSTALL_PREFIX=/usr ..
}

package() {
    cd "${srcdir}/hipSYCL/build"
    VERBOSE=1 DESTDIR=${pkgdir} make install
}
